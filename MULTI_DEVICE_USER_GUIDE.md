# 多端同步用户ID设置指南

## 🎯 功能说明

为了实现多台设备间的数据同步，您需要在所有设备上使用**相同的用户ID**。

### 工作原理

1. **用户ID存储在云端数据中**：每次上传数据时，系统会将用户ID作为元数据一起保存
2. **下载数据时验证用户ID**：系统会检查云端数据的用户ID是否与当前设备匹配
3. **一个JSONBin账户 = 一个云端数据源**：所有设备共享同一个Bin ID，通过用户ID区分不同用户
4. **自动同步**：所有使用相同用户ID的设备会自动同步相同的数据

## 📱 使用步骤

### 第一步：在第一台设备上设置用户ID

1. **打开应用**，点击右上角的 **👤 用户** 按钮
2. **生成新ID**：
   - 如果是首次使用，点击"修改用户ID"按钮
   - 点击"生成新ID"按钮，系统会自动生成一个唯一的用户ID
   - 点击"保存"按钮
3. **等待上传**：
   - 系统会自动将当前数据上传到云端
   - 查看右上角同步状态，确保显示绿色✅
4. **复制ID**：
   - 点击"复制"按钮，将用户ID复制到剪贴板
   - **重要**：请将这个ID保存到安全的地方（如备忘录、密码管理器等）

### 第二步：在其他设备上使用相同的用户ID

1. **打开应用**，点击右上角的 **👤 用户** 按钮
2. **输入ID**：
   - 点击"修改用户ID"按钮
   - 粘贴刚才复制的用户ID
   - 点击"保存"按钮
3. **自动同步**：
   - 系统会自动检查云端数据
   - 验证用户ID是否匹配
   - 如果匹配，自动下载并应用云端数据
   - 页面会自动刷新
4. **完成**：同步完成！

## 📋 用户ID格式示例

```
user_1700123456789_abc123xyz
```

- 格式：`user_时间戳_随机字符串`
- 长度：约30个字符
- 唯一性：每个ID都是全球唯一的

## ⚠️ 重要提示

### 1. **请妥善保管您的用户ID**
- 用户ID是访问您云端数据的唯一凭证
- 如果丢失，将无法在新设备上同步数据
- 建议保存在多个安全位置

### 2. **更换用户ID的注意事项**
- 更换用户ID后，系统会检查云端数据的用户ID
- 如果云端数据属于其他用户ID，会提示错误
- 如果云端没有数据或数据匹配，会上传当前设备的数据
- **建议**：首次设置后不要随意更改

### 3. **多设备同步机制**
- 所有使用相同用户ID的设备将共享同一份云端数据
- 修改数据后会自动同步到云端（带用户ID验证）
- 其他设备会在下次轮询时（约30秒）获取更新
- **安全性**：下载数据时会验证用户ID，确保不会下载其他用户的数据

### 4. **JSONBin账户与用户ID的关系**
- **JSONBin API Key**：识别您的JSONBin账户（一个账户可以存储多个Bin）
- **Bin ID**：云端数据的存储位置（自动生成，所有设备共享）
- **用户ID**：识别数据的所有者（存储在Bin中，用于多端同步验证）

```
JSONBin账户 (API Key)
    └── Bin ID (云端数据)
           └── 数据 + 用户ID (user_123_abc)
```

## 🔧 常见问题

### Q1: 如何知道已经成功同步？
**A:** 查看右上角的同步状态指示器：
- 🟢 绿色：同步成功
- 🟡 黄色：同步中
- 🔴 红色：同步失败

### Q2: 两台设备的数据不一致怎么办？
**A:** 
1. 确认两台设备使用的是**相同的用户ID**（点击👤用户查看）
2. 确认两台设备使用的是**相同的JSONBin API Key**
3. 点击同步状态指示器，手动触发同步
4. 等待30秒-1分钟，让自动轮询完成同步
5. 如果还是不一致，尝试刷新页面

### Q3: 忘记了用户ID怎么办？
**A:** 
1. 在任何一台已登录的设备上，点击 **👤 用户** 按钮
2. 当前用户ID会显示在界面上
3. 点击"复制"按钮重新保存

### Q4: 提示"用户ID不匹配"怎么办？
**A:** 
这说明云端数据属于另一个用户ID，可能的原因：
1. 输入的用户ID不正确（检查是否完整复制）
2. 使用了不同的JSONBin账户（多个人共用时）
3. **解决方案**：
   - 方案1：使用正确的用户ID
   - 方案2：如果确定要使用新用户ID，先导出旧数据备份，然后创建新用户ID

### Q5: 可以在多少台设备上使用？
**A:** 
- 理论上没有设备数量限制
- 只要使用相同的用户ID和API Key即可
- 但同时编辑可能导致数据冲突，建议按需使用

### Q6: 用户ID是否安全？
**A:** 
- 用户ID本身不包含个人信息
- 配合API Key使用，双重保护
- 只要不同时泄露API Key和用户ID，他人无法访问您的数据
- 云端存储使用JSONBin.io加密传输

### Q7: 换了新设备或重装系统后怎么恢复数据？
**A:**
1. 安装应用后，先配置JSONBin API Key
2. 点击 👤 用户，输入之前的用户ID
3. 点击保存，系统会自动从云端下载数据
4. 等待页面刷新，数据恢复完成！

## 🚀 快速设置流程

```
设备A（首次）          设备B（新设备）
   ↓                      ↓
打开应用               打开应用
   ↓                      ↓
配置API Key           配置API Key
   ↓                      ↓
点击👤用户             点击👤用户
   ↓                      ↓
生成新ID               修改用户ID
   ↓                      ↓
保存                   粘贴设备A的ID
   ↓                      ↓
上传数据到云端          保存
   ↓                      ↓
复制用户ID             验证用户ID
                          ↓
                      下载云端数据
                          ↓
                      页面自动刷新
                          ↓
                      同步完成！
```

## 🔐 安全最佳实践

1. **不要分享用户ID**：除非您想让其他设备访问您的数据
2. **保护API Key**：不要将API Key暴露在公开环境
3. **定期备份**：使用"📦 数据"功能导出数据备份
4. **验证同步**：换设备后检查数据是否完整

## 📞 技术支持

如遇到同步问题，请检查：
1. ✅ 网络连接是否正常
2. ✅ JSONBin API密钥是否已配置且正确
3. ✅ 用户ID是否在所有设备上完全一致（注意空格、大小写）
4. ✅ 浏览器控制台是否有错误信息
5. ✅ 同步状态指示器的颜色

**调试步骤：**
1. 打开浏览器控制台（F12）
2. 查看是否有红色错误信息
3. 手动点击同步状态触发同步
4. 查看控制台输出的详细日志

---

**提示**：建议定期使用"📦 数据"功能导出数据备份，以防万一。
